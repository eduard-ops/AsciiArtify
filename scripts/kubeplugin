#!/bin/bash

# Check if namespace argument is provided
if [ -z "$1" ]; then
    echo "Usage: $0 <namespace>"
    exit 1
fi

# Set the namespace
NAMESPACE=$1

# Retrieve resource usage statistics from Kubernetes
kubectl get pods --namespace="$NAMESPACE" -o custom-columns=NAME:.metadata.name,CPU:.spec.containers[*].usage.cpu,MEMORY:.spec.containers[*].usage.memory --no-headers | while read -r line
do
  # Extract CPU and memory usage from the output
  NAME=$(echo "$line" | awk '{print $1}')
  CPU=$(echo "$line" | awk '{print $2}')
  MEMORY=$(echo "$line" | awk '{print $3}')

  # Output the statistics to the console
  echo "Resource, Namespace, Name, CPU, Memory"
  echo "Pod, $NAMESPACE, $NAME, $CPU, $MEMORY"
done